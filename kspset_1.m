function kspset_1
tic
G = [0 1 0 0 0 0 0 0 1 0 0 0 0 1 0 0 0 0 0 0;
 1 0 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
 0 1 0 0 1 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0;
 0 1 0 0 0 1 0 1 0 0 0 0 0 0 0 0 0 0 0 0;
 0 0 1 0 0 0 0 0 1 1 0 0 0 0 0 0 0 0 0 0;
 0 0 0 1 0 0 0 0 0 0 0 0 1 1 0 0 0 0 0 0;
 0 0 1 0 0 0 0 1 0 0 1 0 0 0 0 0 0 0 0 0;
 0 0 0 1 0 0 1 0 0 0 0 1 0 0 0 0 0 0 0 0;
 1 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0;
 0 0 0 0 1 0 0 0 0 0 1 0 0 0 1 0 0 0 0 0;
 0 0 0 0 0 0 1 0 0 1 0 0 0 0 0 0 0 0 0 1;
 0 0 0 0 0 0 0 1 0 0 0 0 1 0 0 0 0 0 0 1;
 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 1 0 0 0;
 1 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 1 0;
 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 1 0 1 0 0;
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 1 0 0 1;
 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 0 0 1 0;
 0 0 0 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 1 0;
 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 0;
 0 0 0 0 0 0 0 0 0 0 1 1 0 0 0 1 0 0 0 0;];

% G = [0 1 1 1 0 0 0 0 0 0;
%  1 0 1 0 0 0 1 0 0 0;
%  1 1 0 1 1 1 1 0 0 0;
%  1 0 1 0 1 0 0 0 0 0;
%  0 0 1 1 0 1 0 0 1 0;
%  0 0 1 0 1 0 1 1 1 1;
%  0 1 1 0 0 1 0 1 0 0;
%  0 0 0 0 0 1 1 0 0 1;
%  0 0 0 0 1 1 0 0 0 1;
%  0 0 0 0 0 1 0 1 1 0]
G = [0 1 0 0 0 0 0 1;
    1 0 1 0 0 0 1 1;
    0 1 0 1 0 0 1 0;
    0 0 1 0 1 1 0 0;
    0 0 0 1 0 1 0 0;
    0 0 0 1 1 0 1 0;
    0 1 1 0 0 1 0 1;
    1 1 0 0 0 0 1 0]
G = [0 1 0 0 0 0 0 1 1 0 1 0 0 0;
     1 0 1 0 0 0 0 0 0 0 0 0 0 0;
     0 1 0 1 0 0 0 0 0 0 0 0 0 0;
     0 0 1 0 1 0 0 0 0 0 0 0 0 0;
     0 0 0 1 0 1 0 0 0 0 0 0 0 0;
     0 0 0 0 1 0 1 0 0 1 0 0 0 1;
     0 0 0 0 0 1 0 1 1 1 0 0 0 0;
     1 0 0 0 0 0 1 0 1 1 0 0 0 0;
     1 0 0 0 0 0 1 1 0 1 0 0 0 0;
     0 0 0 0 0 1 1 1 1 0 0 0 0 0;
     1 0 0 0 0 0 0 0 0 0 0 1 0 0;
     0 0 0 0 0 0 0 0 0 0 1 0 1 0;
     0 0 0 0 0 0 0 0 0 0 0 1 0 1;
     0 0 0 0 0 1 0 0 0 0 0 0 1 0]
S = 1;
T = 6;
K = 20;
p = 0.9;

G = Zzxadtodis(G);
a = Zzxkspset(G ,S, T, K);
a_n = size(a,1);
G_n = zeros( length(G),length(G) );
for i = 1:a_n
    G_n( a(i,1),a(i,2) ) = 1;
    G_n( a(i,2),a(i,1) ) = 1;
end

G_n
G_ndis = Zzxadtodis(G_n);

b = Zzxkspset(G_ndis ,S, T, 1000);
b
b_ind = find(b == S);


% while  length( b_ind ) == K
%        length( b_ind );
%        K = K + 1;
%        b = Zzxkspset(G_ndis ,S, T, K);
%        b_ind = find(b == S);
% end
b_ind;
b_ind1 = [b_ind ; length(b)+1];
for i = 1:length(b_ind)
    a = [];
    for j = b_ind1(i) : b_ind1(i+1)-1
        a = [ a , (b(j,1)-1)*20 + b(j,2) ];
    end
    A{i,1} = a;
end
A

 Zzxinexprinciple(A,p)
toc




